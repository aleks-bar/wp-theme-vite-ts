# Установка через `composer`
```
composer create-project aleks-bar/wp-theme-vite-ts директория-темы
```

# Настройка
> Для корректной работы нужно выполнить команды в папке темы
<br>

*Для установки зависимостей*

```
npm install
```

*Для инициализации файлов необходимых теме*

```
num run dev или npm run build
```
# Система чанков
В теме можно асинхронно подгружать js и css чанки по условию в основном js файле `index.ts`.
Для создания чанка необходимо в директории `chunks` добавить файлы чанков, так же импортированные туда css файлы будут биться на чанки css.
После этого необходимо в основном js файле использовать метод `addLazyChunkForApp` для асинхронной загрузки чанка.
В этот метод необходимо передать объект приложения `app` и объект с именами чанков и функциями импорта нужных чанков.
<br>
<br>
Пример:
<br>
```
addLazyChunkForApp( app,
   {
     'chunk-1': () => import('путь/до/чанка-1'),
     'chunk-2': () => import('путь/до/чанка-2'),
   }
)
```
<br>

> [!WARNING]
> Внутрь `impor()` нельзя передать переменную, т.к. vite не увидит путь и не сбилдит чанк.

<br>

Но перед вызовом метода необходимоо проинициировать зависимости у объекта `app`.
<br>

> app.initDependencies()
<br>

После этого для работы чанков необходимо в `php` файле страницы перед вызовом шапки установить имя чанка соответствующего его имени в объекте с чанками для метода `addLazyChunkForApp`.
<br>
<br>
Пример:
<br>
```
Theme::setChunkName('chunk-1');
get_header();
```
<br>

Метод `addLazyChunkForApp` рассчитан на подключение глобального чанка для всей страницы, если потребуется подключить чанк по условию где - то локально, то можно использовать метод `chunkLazy`. <br>
<br>
Принимает первым параметром функцию возвращающую `import('путь/до/чанка')`, а вторым имя чанка <br>
<br>
Он возвращает объект в котором: <br>
`data` - данные о загрузке чанка, нучжно передать в метод `chunkInit` <br>
`chunkInit` - метод который нужно вызвать после загрузки чанка, принимает данные о загрузке чанка `data` и объект приложения `app` <br>
`chunkLoad` - промис вызывающий загрузку чанка
<br>
<br>
Пример:
<br>
```
const { chunkLoad, data, chunkInit } = chunkLazy( () => import('путь/до/чанка'), chunk-1 );
chunkLoad().then( () => chunkInit(data, app) )
```
